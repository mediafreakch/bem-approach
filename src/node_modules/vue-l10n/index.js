module.exports = {
  install: function (Vue) {
    Vue.prototype.$l10n = function(message, params = null, lang) {
      var urlLocale = this.$store.state.route.params.local || 'default',
          locals = this.$store.getters.locals;

      // render a specific lang given
      if (lang && locals[lang]) {
        return locals[lang][message].format(params) || message;
      }

      // render lang given by url
      if (locals[urlLocale]) {
        if (locals[urlLocale][message]) {
          // there is a translated message for the given language
          return locals[urlLocale][message].format(params);
        } else if (locals['default'][message]) {
          // try default language if there is no translated message for the given language
          return locals['default'][message].format(params);
        } else {
          // if a language was specified but we have no translations, return plain message key
          return message;
        }
      }

      // in case no language has been defined, just return the key
      return message;
    }
  }
};
