<template>
  <r-alert v-if="message" :type="message.type">{{ message.body }}</alert>
</template>
<script>
  var alert = require('component~alert');

  module.exports = {
    components: {
      'r-alert': alert
    },
    route: {
      data: function(transition) {
        transition.next({
          token: transition.to.params.token
        });
      }
    },
    data: function() {
      return {
        token: null,
        message: null
      }
    },
    methods: {
      verifyToken: function() {
        return this.$http.post('http://localhost:3000/users/123/email/verify', { data: { token: this.token } });
      }
    },
    ready: function() {
      this.verifyToken()
        .then(function(response) {
          this.message = {
            type: 'success',
            body: response.data.message
          };
        }, function(response) {
          this.message = {
            type: 'danger',
            body: 'uuups'
          };
        });
    }
  };
</script>
