<style lang="less">

</style>

<template>
  <h1>Konto wiederherstellen</h1>
  <r-alert
      type="success"
      icon="checkmark"
  >Danke!</r-alert>
  <p>
    Sie wurden als Inhaber dieses Kontos bestätigt. Aktualisieren Sie jetzt
    Ihre E-Mail-Adresse und Ihr Passwort.
  </p>
  <r-alert
      type="warning"
      icon="alert"
  >Prüfen Sie vor dem Absenden sorgfältig Ihre neue E&#8209;Mail-Adresse.</r-alert>
  <form>
    <r-form-item
        variant="email"
        label="Neue E-Mail-Addresse"
        input-id="newEmail"
        type="email"
        validation-type="['required', 'email']"
        validation-message="['Bitte füllen Sie dieses Feld aus um weiterzufahren.', 'Bitte geben Sie eine gültige E&#8209;Mail-Adresse ein.']"
        :vuexNameSpace="formReCreateEmailAndPassword"
        :readonly="isAccountRestored"
        @value-change="inputChanged"
        @input-enter="tryToSendForm"
    ></r-form-item>
    <r-form-item
        variant="password"
        label="Neues Passwort"
        validation-type="['required']"
        validation-message="['Bitte füllen Sie dieses Feld aus um weiterzufahren']"
        input-id="newPassword"
        type="password"
        @value-change="inputChanged"
        @input-enter="tryToSendForm"
    ></r-form-item>

    <button
        @click.prevent="tryToSendForm"
        class="btn btn-primary btn-block btn-iconed"
    >
      {{submitWording}}
      <span v-if="isRequestSmsRetrievingData">&nbsp;<span class="icon icon-spinner rotating"></span></span>
    </button>
  </form>


</template>

<script>

  var
    alert = require( 'component~alert' ),
    formElements = require('element~form-elements'),
    formItem = formElements.components.formItem,
    vuexActions = require('./vuex/actions'),
    vuexGetters = require('./vuex/getters'),
    api = require('./js/api');


  module.exports = {
    components: {
      'r-alert': alert,
      'r-form-item': formItem
    },
    vuex:{
      actions: vuexActions,
      getters: vuexGetters
    },
    computed: {
      submitWording: function() {
        return 'Konto aktualisieren';
      }
    },
    methods: {
      inputChanged: function() {
        console.log('inputChanged');
      },
      formReCreateEmailAndPasswordTryToSend: function() {
        api.sendRecreateEmailAndPassword(this);
      },
      tryToSendForm: function() {
        this[this.activeForm + 'TryToSend']()
      }
    }
  };

</script>