'use strict';

var api = require('app_api');

var state = {
  user: null
};

var getters = {
  user: function(state) {
    return state.user;
  }
};

var mutations = {
  USERINFO_SUCCESS: function(state, payload) {
    state.user = payload.user;
  },
  USERINFO_FAILURE: function(state, payload) {
    state.user = null;
  },
  UPDATE_USERINFO_SUCCESS: function(state, payload) {
    state.user = payload.user;
  }
};

var actions = {
  getUserInfo: function(store) {
    return api.getUserInfo().then(function(res) {
      if(!res.ok) {
        return store.commit('USERINFO_FAILURE');
      }
      store.commit('USERINFO_SUCCESS', { user: res.data });
    }, function(res) {
      store.commit('USERINFO_FAILURE');
    });
  }
};

module.exports = {
  state: state,
  mutations: mutations,
  actions: actions,
  getters: getters
}
